tosca_definitions_version: tosca_simple_yaml_1_3

namespace: terraform

description: >
  Base node type definition.

metadata:
  template_name: custom types
  puccini.scriptlet.import:terraform.generate: js/generate.js


data_types:

  container.datatypes.network:
    derived_from: tosca.datatypes.Root
    properties:
      name:
        type: string
        required: true
      aliases:
        description: The network aliases of the container in the specific network
        type: list
        entry_schema:
          type: string
        required: false
      ipv4_address:
        type: string
        required: false
      ipv6_address:
        type: string
        required: false
  
  container.datatypes.port:
    derived_from: tosca.datatypes.Root
    properties:
      internal:
        type: integer
        required: true
      external:
        type: integer
        required: true
      protocol:
        type: string
        required: false
        default: tcp
      ip:
        description: ip that can access the port
        type: string
        required: false
        default: 0.0.0.0

  container.datatypes.volume:
    derived_from: tosca.datatypes.Root
    properties:
      volume_name:
        type: string
        required: false
      container_path:
        type: string
        required: false
      host_path:
        type: string
        required: false



node_types:

  terraform_host:
    description: general host node for terraform compability
    derived_from: tosca.nodes.Root
    properties:
      name:
        type: string
        required: true
      hostname:
        type: string
        required: false
      image:
        type: string
        required: false
      user:
        type: string
        required: false
      networks_advanced:
        type: container.datatypes.network
        required: false
      ports:
        type: container.datatypes.port
        required: false
      init:
        type: boolean
        default: true
        required: false
      command:
        type: list
        entry_schema:
          type: string
        required: false
      env:
        type: map
        entry_schema:
          type: string
        required: false
      volumes:
        type: list
        entry_schema:
          type: container.datatypes.volume
        required: false

  
  terraform_network:
    description: general network node for terraform compability
    derived_from: tosca.nodes.Root
    properties:
      name:
        type: string
        required: true
      driver:
        type: string
        default: bridge
        required: false
      ip_version:
        type: integer
        default: 4
        required: false
    attributes:
      subnet:
        type: string
        default: 192.168.80.0/20
      gateway:
        type: string
        default: 192.168.80.1

